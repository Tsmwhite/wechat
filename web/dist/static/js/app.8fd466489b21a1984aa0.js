webpackJsonp([3],{"4ml/":function(n,t){},"6acS":function(n,t,e){"use strict";var o=e("wy+4");t.a=function(n){o.c.dispatch("push",n)}},"9GPK":function(n,t,e){"use strict";e.d(t,"b",function(){return h}),e.d(t,"a",function(){return p}),e.d(t,"c",function(){return m}),e.d(t,"f",function(){return v}),e.d(t,"e",function(){return _}),e.d(t,"d",function(){return k});var o=e("mvHQ"),i=e.n(o),r=e("BO1k"),a=e.n(r),c="Tsmwhite:",s=function(n,t){window.localStorage.setItem(c+n,t)},u=function(n){return window.localStorage.getItem(c+n)},l=function(n){return window.localStorage.removeItem(c+n)},f=["token","user-info"],d={},h=function(){return d.token||(d.token=u("token")),d.token},p=function(){if(!d.uuid){var n=u("user-info");n=JSON.parse(n),d.uuid=n.uuid}return d.uuid},m=function(){if(!d.userInfo){var n=u("user-info");d.userInfo=JSON.parse(n)}return d.userInfo||{}},v=function(){var n=!0,t=!1,e=void 0;try{for(var o,i=a()(f);!(n=(o=i.next()).done);n=!0){var r=o.value;l(r)}}catch(n){t=!0,e=n}finally{try{!n&&i.return&&i.return()}finally{if(t)throw e}}},_=function(n){s("token",n.token),s("user-info",i()(n))},k=function(){var n=u("token");return null!==n&&""!==n}},NHnr:function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("7+uW"),i={render:function(){var n=this.$createElement,t=this._self._c||n;return t("div",{staticClass:"main-tab"},[t("div",[t("van-icon",{staticClass:"icon",attrs:{name:"chat"}})],1),this._v(" "),t("div",[t("van-icon",{staticClass:"icon",attrs:{name:"friends-o"}})],1),this._v(" "),t("div",[t("van-icon",{staticClass:"icon",attrs:{name:"fire-o"}})],1),this._v(" "),t("div",[t("van-icon",{staticClass:"icon",attrs:{name:"manager-o"}})],1)])},staticRenderFns:[]};var r={name:"App",components:{MainTab:e("VU/8")({name:"main-tab"},i,!1,function(n){e("eeW5")},"data-v-0492bc3b",null).exports}},a={render:function(){var n=this.$createElement,t=this._self._c||n;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var c=e("VU/8")(r,a,!1,function(n){e("z64/")},null,null).exports,s=e("/ocq"),u=e("9GPK");o.a.use(s.a);var l=new s.a({routes:[{path:"/",name:"index",component:function(){return e.e(0).then(e.bind(null,"mlqX"))},meta:{auth:!0}},{path:"/index",name:"index",component:function(){return e.e(0).then(e.bind(null,"mlqX"))},meta:{auth:!0}},{path:"/login",name:"login",component:function(){return e.e(1).then(e.bind(null,"Quw4"))}}]});l.beforeEach(function(n,t,e){var o=n.meta.auth||!1;console.log("hasAuth",o,Object(u.d)()),!o||Object(u.d)()?e():e("/login")});var f=l,d=e("Fd2+"),h=(e("4ml/"),e("ammU")),p=e("jdbf"),m=e("wy+4");o.a.use(d.a),o.a.use(d.c),o.a.prototype.$WebSocket=h.a,o.a.prototype.$MsgType={Text:400,Image:401},o.a.prototype.$Chat=p.a,o.a.prototype.$SetR=p.b,o.a.config.productionTip=!1,new o.a({el:"#app",router:f,store:m.c,components:{App:c},template:"<App/>"})},ammU:function(n,t,e){"use strict";(function(n){var o=e("mvHQ"),i=e.n(o),r=e("jdbf"),a=e("6acS"),c=e("9GPK"),s={Error:"",MessageHandleCallback:null,_token:"",_socket:null,_heartTimeout:8e3,_heartTimer:null,_closeTimer:null,_closeFlag:!1,_reConnMax:1,_reConnCounter:0,Socket:function(){return null===this._socket&&this.Init(),this._socket},Init:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===this._socket)return!!this.Func.isSupportWs()&&(this._token=n||Object(c.b)(),this.WsInit(),this)},Func:{isSupportWs:function(){return"function"==typeof WebSocket||(this.setError("不支持 websocket 通信协议"),!1)},setError:function(n){this.Error=n},getError:function(){return this.Error}},WsInit:function(){var t=this;this._closeFlag=!1,this._socket=new WebSocket(n.WEB_SOCKET_SERVER,this._token),this._socket.onopen=function(n){t._OPEN(n)},this._socket.onclose=function(n){t._CLOSE(n)},this._socket.onmessage=function(n){t._MESSAGE(n)},this._socket.onerror=function(n){t._ERROR(n)}},WsFuncInit:function(){var n=this;this._OPEN=function(t){console.log("OPEN",t),n._reConnCounter=0,n.heart()},this._CLOSE=function(t){console.log("CLOSE",t),!n._closeFlag&&n.reconnect()},this._MESSAGE=function(t){if("function"==typeof n.MessageHandleCallback)return n.MessageHandleCallback(JSON.parse(t.data))},this._ERROR=function(t){console.log("ERROR",t),n.Func.setError(t)},this.heart=function(){n._heartTimer=setInterval(function(){n.Socket().send(i()(r.a.ping()))},n._heartTimeout)},this.reconnect=function(){n._reConnCounter++,n._reConnCounter>n._reConnMax||(clearInterval(n._heartTimer),n.WsInit())},this.send=function(t){switch(n.Socket().readyState){case WebSocket.OPEN:n.Socket().send(i()(t)),n.MessageHandleCallback(t);break;case WebSocket.CONNECTING:setTimeout(function(){n.send(t)},3e3);break;case WebSocket.CLOSED:case WebSocket.CLOSING:n.Socket().close()}},this.close=function(){clearInterval(n._heartTimer),n._closeFlag=!0,n._socket.close(),n._socket=null}}};s.MessageHandleCallback=a.a,s.WsFuncInit(),t.a=s}).call(t,e("W2nU"))},eeW5:function(n,t){},jdbf:function(n,t,e){"use strict";e.d(t,"b",function(){return s}),e.d(t,"a",function(){return u});var o=e("Dd8w"),i=e.n(o),r=e("9GPK"),a={Recipient:""},c=function(){return{recipient:a.Recipient,sender:Object(r.a)(),send_time:Math.ceil((new Date).getTime()/1e3)}},s=function(n){a.Recipient=n},u={ping:function(){return{content:"ping",type:0}},text:function(n){return i()({content:n,type:200,second_type:400},c())},image:function(n){return i()({content:n,type:200,second_type:401},c())}}},"wy+4":function(n,t,e){"use strict";var o=e("7+uW"),i=e("NYxO"),r=e("Gu7T"),a=e.n(r),c={state:{MessageMapList:{0:[]}},mutations:{PUSH_MSG:function(n,t){if(console.log("PUSH_MSG",t),n.MessageMapList[t.recipient]){var e=[].concat(a()(n.MessageMapList[t.recipient]),[t]);o.a.set(n.MessageMapList,t.recipient,e)}else o.a.set(n.MessageMapList,t.recipient,[t])},READ_MSG:function(n,t){t.recipient,t.messageIds}},actions:{push:function(n,t){(0,n.commit)("PUSH_MSG",t)}},getters:{}},s=e("BO1k"),u=e.n(s),l=["token","uuid","name","mobile","mail","avatar","role_id"],f={state:{token:"",uuid:"",name:"",mobile:"",mail:"",avatar:"",role_id:""},mutations:{SET:function(n,t){var e=!0,o=!1,i=void 0;try{for(var r,a=u()(l);!(e=(r=a.next()).done);e=!0){var c=r.value;n[c]=t[c]}}catch(n){o=!0,i=n}finally{try{!e&&a.return&&a.return()}finally{if(o)throw i}}},CLEAR:function(n){var t=!0,e=!1,o=void 0;try{for(var i,r=u()(l);!(t=(i=r.next()).done);t=!0){n[i.value]=""}}catch(n){e=!0,o=n}finally{try{!t&&r.return&&r.return()}finally{if(e)throw o}}}},actions:{},getter:{}};e.d(t,"a",function(){return h}),e.d(t,"b",function(){return p}),o.a.use(i.a);var d=new i.a.Store({modules:{msg:c,user:f}}),h=(t.c=d,function(n){d.commit("SET",n)}),p=function(){d.commit("CLEAR")}},"z64/":function(n,t){}},["NHnr"]);
//# sourceMappingURL=app.8fd466489b21a1984aa0.js.map