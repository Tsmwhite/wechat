webpackJsonp([3],{"4ml/":function(t,n){},"9GPK":function(t,n,e){"use strict";e.d(n,"b",function(){return h}),e.d(n,"a",function(){return p}),e.d(n,"c",function(){return m}),e.d(n,"f",function(){return v}),e.d(n,"e",function(){return _}),e.d(n,"d",function(){return k});var o=e("mvHQ"),i=e.n(o),r=e("BO1k"),a=e.n(r),c="Tsmwhite:",s=function(t,n){window.localStorage.setItem(c+t,n)},u=function(t){return window.localStorage.getItem(c+t)},l=function(t){return window.localStorage.removeItem(c+t)},f=["token","user-info"],d={},h=function(){return d.token||(d.token=u("token")),d.token},p=function(){if(!d.uuid){var t=u("user-info");t=JSON.parse(t),d.uuid=t.uuid}return d.uuid},m=function(){if(!d.userInfo){var t=u("user-info");d.userInfo=JSON.parse(t)}return d.userInfo||{}},v=function(){var t=!0,n=!1,e=void 0;try{for(var o,i=a()(f);!(t=(o=i.next()).done);t=!0){var r=o.value;l(r)}}catch(t){n=!0,e=t}finally{try{!t&&i.return&&i.return()}finally{if(n)throw e}}},_=function(t){s("token",t.token),s("user-info",i()(t))},k=function(){var t=u("token");return null!==t&&""!==t}},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=e("7+uW"),i={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"main-tab"},[n("div",[n("van-icon",{staticClass:"icon",attrs:{name:"chat"}})],1),this._v(" "),n("div",[n("van-icon",{staticClass:"icon",attrs:{name:"friends-o"}})],1),this._v(" "),n("div",[n("van-icon",{staticClass:"icon",attrs:{name:"fire-o"}})],1),this._v(" "),n("div",[n("van-icon",{staticClass:"icon",attrs:{name:"manager-o"}})],1)])},staticRenderFns:[]};var r={name:"App",components:{MainTab:e("VU/8")({name:"main-tab"},i,!1,function(t){e("eeW5")},"data-v-0492bc3b",null).exports}},a={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var c=e("VU/8")(r,a,!1,function(t){e("z64/")},null,null).exports,s=e("/ocq"),u=e("9GPK");o.a.use(s.a);var l=new s.a({routes:[{path:"/",name:"index",component:function(){return e.e(0).then(e.bind(null,"mlqX"))},meta:{auth:!0}},{path:"/index",name:"index",component:function(){return e.e(0).then(e.bind(null,"mlqX"))},meta:{auth:!0}},{path:"/login",name:"login",component:function(){return e.e(1).then(e.bind(null,"Quw4"))}}]});l.beforeEach(function(t,n,e){var o=t.meta.auth||!1;console.log("hasAuth",o,Object(u.d)()),!o||Object(u.d)()?e():e("/login")});var f=l,d=e("Fd2+"),h=(e("4ml/"),e("mvHQ")),p=e.n(h),m=e("Dd8w"),v=e.n(m),_={Recipient:""},k=function(){return{recipient:_.Recipient,sender:Object(u.a)(),send_time:Math.ceil((new Date).getTime()/1e3)}},g={ping:function(){return{content:"ping",type:0}},text:function(t){return v()({content:t,type:200,second_type:400},k())},image:function(t){return v()({content:t,type:200,second_type:401},k())}},S=e("wy+4"),b={Error:"",MessageHandleCallback:null,_token:"",_socket:null,_heartTimeout:8e3,_heartTimer:null,_closeTimer:null,_closeFlag:!1,_reConnMax:1,_reConnCounter:0,Socket:function(){return null===this._socket&&this.Init(),this._socket},Init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===this._socket)return!!this.Func.isSupportWs()&&(this._token=t||Object(u.b)(),this.WsInit(),this)},Func:{isSupportWs:function(){return"function"==typeof WebSocket||(this.setError("不支持 websocket 通信协议"),!1)},setError:function(t){this.Error=t},getError:function(){return this.Error}},WsInit:function(){var t=this;this._closeFlag=!1,this._socket=new WebSocket("wss://120.26.1.206:8011/ws",this._token),this._socket.onopen=function(n){t._OPEN(n)},this._socket.onclose=function(n){t._CLOSE(n)},this._socket.onmessage=function(n){t._MESSAGE(n)},this._socket.onerror=function(n){t._ERROR(n)}},WsFuncInit:function(){var t=this;this._OPEN=function(n){console.log("OPEN",n),t._reConnCounter=0,t.heart()},this._CLOSE=function(n){console.log("CLOSE",n),!t._closeFlag&&t.reconnect()},this._MESSAGE=function(n){if("function"==typeof t.MessageHandleCallback)return t.MessageHandleCallback(JSON.parse(n.data))},this._ERROR=function(n){console.log("ERROR",n),t.Func.setError(n)},this.heart=function(){t._heartTimer=setInterval(function(){t.Socket().send(p()(g.ping()))},t._heartTimeout)},this.reconnect=function(){t._reConnCounter++,t._reConnCounter>t._reConnMax||(clearInterval(t._heartTimer),t.WsInit())},this.send=function(n){switch(t.Socket().readyState){case WebSocket.OPEN:t.Socket().send(p()(n)),t.MessageHandleCallback(n);break;case WebSocket.CONNECTING:setTimeout(function(){t.send(n)},3e3);break;case WebSocket.CLOSED:case WebSocket.CLOSING:t.Socket().close()}},this.close=function(){clearInterval(t._heartTimer),t._closeFlag=!0,t._socket.close(),t._socket=null}}};b.MessageHandleCallback=function(t){S.c.dispatch("push",t)},b.WsFuncInit();var E=b;o.a.use(d.a),o.a.use(d.c),o.a.prototype.$WebSocket=E,o.a.prototype.$MsgType={Text:400,Image:401},o.a.prototype.$Chat=g,o.a.prototype.$SetR=function(t){_.Recipient=t},o.a.config.productionTip=!1,new o.a({el:"#app",router:f,store:S.c,components:{App:c},template:"<App/>"})},eeW5:function(t,n){},"wy+4":function(t,n,e){"use strict";var o=e("7+uW"),i=e("NYxO"),r=e("Gu7T"),a=e.n(r),c={state:{MessageMapList:{0:[]}},mutations:{PUSH_MSG:function(t,n){if(console.log("PUSH_MSG",n),t.MessageMapList[n.recipient]){var e=[].concat(a()(t.MessageMapList[n.recipient]),[n]);o.a.set(t.MessageMapList,n.recipient,e)}else o.a.set(t.MessageMapList,n.recipient,[n])},READ_MSG:function(t,n){n.recipient,n.messageIds}},actions:{push:function(t,n){(0,t.commit)("PUSH_MSG",n)}},getters:{}},s=e("BO1k"),u=e.n(s),l=["token","uuid","name","mobile","mail","avatar","role_id"],f={state:{token:"",uuid:"",name:"",mobile:"",mail:"",avatar:"",role_id:""},mutations:{SET:function(t,n){var e=!0,o=!1,i=void 0;try{for(var r,a=u()(l);!(e=(r=a.next()).done);e=!0){var c=r.value;t[c]=n[c]}}catch(t){o=!0,i=t}finally{try{!e&&a.return&&a.return()}finally{if(o)throw i}}},CLEAR:function(t){var n=!0,e=!1,o=void 0;try{for(var i,r=u()(l);!(n=(i=r.next()).done);n=!0){t[i.value]=""}}catch(t){e=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(e)throw o}}}},actions:{},getter:{}};e.d(n,"a",function(){return h}),e.d(n,"b",function(){return p}),o.a.use(i.a);var d=new i.a.Store({modules:{msg:c,user:f}}),h=(n.c=d,function(t){d.commit("SET",t)}),p=function(){d.commit("CLEAR")}},"z64/":function(t,n){}},["NHnr"]);
//# sourceMappingURL=app.1a8bb7683739c642f90b.js.map