{"version":3,"sources":["webpack:///./src/library/message/handle.js","webpack:///./src/utis/cache.js","webpack:///./src/components/base/main-tab.vue?ed7b","webpack:///./src/components/base/main-tab.vue","webpack:///src/App.vue","webpack:///src/components/base/main-tab.vue","webpack:///./src/App.vue?d6f2","webpack:///./src/App.vue","webpack:///./src/router/index.js","webpack:///./src/main.js","webpack:///./src/library/message/type.js","webpack:///./src/library/socket/web-socket.js","webpack:///./src/library/message/chat.js","webpack:///./src/stores/modules/message.js","webpack:///./src/stores/modules/user.js","webpack:///./src/stores/index.js"],"names":["__WEBPACK_IMPORTED_MODULE_0__stores_index__","__webpack_require__","__webpack_exports__","messageObj","store","dispatch","PREFIX","SetLocalStorage","key","value","window","localStorage","setItem","GetLocalStorage","getItem","RemoveLocalStorage","removeItem","localStorageKeys","Cache","GetToken","token","GetCurrentUuid","uuid","userInfo","JSON","parse","GetUserInfo","LogoutAfterCache","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_get_iterator___default","next","done","err","return","LoginAfterCache","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default","HasLogin","base_main_tab","render","_h","this","$createElement","_c","_self","staticClass","attrs","name","_v","staticRenderFns","App","components","MainTab","normalizeComponent","ssrContext","selectortype_template_index_0_src_App","id","src_App","App_normalizeComponent","Vue","use","Router","RouterInstance","routes","path","component","e","then","bind","meta","auth","beforeEach","to","form","hasAuth","console","log","Lazyload","Vant","prototype","$WebSocket","WEB_SOCKET","$MsgType","Text","Image","$Chat","Chat","$SetR","setRecipient","config","productionTip","el","router","template","Error","MessageHandleCallback","_token","_socket","_heartTimeout","_heartTimer","_closeTimer","_closeFlag","_reConnMax","_reConnCounter","Socket","Init","arguments","length","Func","isSupportWs","WsInit","WebSocket","setError","getError","_this","process","WEB_SOCKET_SERVER","onopen","_OPEN","onclose","_CLOSE","onmessage","_MESSAGE","onerror","_ERROR","WsFuncInit","_this2","heart","reconnect","data","setInterval","send","ping","clearInterval","message","readyState","OPEN","CONNECTING","setTimeout","CLOSED","CLOSING","close","mesHandleFunc","CurrentChatInfo","Recipient","commonStruct","recipient","sender","send_time","Math","ceil","Date","getTime","content","type","text","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","second_type","image","address","modules_message","state","MessageMapList","0","mutations","PUSH_MSG","list","set","READ_MSG","_ref","messageIds","actions","push","_ref2","commit","getters","keys","user","mobile","mail","avatar","role_id","SET","get_iterator_default","CLEAR","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","getter","d","LoginAfterStore","LogoutAfterStore","Vuex","storeInstance","Store","modules","msg","MsgStore","UserStore"],"mappings":"6EAAA,IAAAA,EAAAC,EAAA,QAEeC,EAAA,WAACC,GACZC,IAAMC,SAAS,OAAQF,uRCHrBG,EAAS,YASFC,EAAkB,SAACC,EAAKC,GACjCC,OAAOC,aAAaC,QAAQN,EAASE,EAAKC,IAGjCI,EAAkB,SAACL,GAC5B,OAAOE,OAAOC,aAAaG,QAAQR,EAASE,IAGnCO,EAAqB,SAACP,GAC/B,OAAOE,OAAOC,aAAaK,WAAWV,EAASE,IAG7CS,GACF,QACA,aAGEC,KAEOC,EAAW,WAIpB,OAHKD,EAAME,QACPF,EAAME,MAAQP,EAAgB,UAE3BK,EAAME,OAGJC,EAAiB,WAC1B,IAAKH,EAAMI,KAAM,CACb,IAAIC,EAAWV,EAAgB,aAC/BU,EAAWC,KAAKC,MAAMF,GACtBL,EAAMI,KAAOC,EAASD,KAE1B,OAAOJ,EAAMI,MAGJI,EAAc,WACvB,IAAKR,EAAMK,SAAU,CACjB,IAAIA,EAAWV,EAAgB,aAC/BK,EAAMK,SAAWC,KAAKC,MAAMF,GAEhC,OAAOL,EAAMK,cAGJI,EAAmB,WAAM,IAAAC,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IAClC,QAAAC,EAAAC,EAAAC,IAAgBjB,KAAhBW,GAAAI,EAAAC,EAAAE,QAAAC,MAAAR,GAAA,EAAkC,KAAzBpB,EAAyBwB,EAAAvB,MAC9BM,EAAmBP,IAFW,MAAA6B,GAAAR,GAAA,EAAAC,EAAAO,EAAA,aAAAT,GAAAK,EAAAK,QAAAL,EAAAK,SAAA,WAAAT,EAAA,MAAAC,KAMzBS,EAAkB,SAAChB,GAC5BhB,EAAgB,QAASgB,EAASH,OAClCb,EAAgB,YAAaiC,IAAejB,KAGnCkB,EAAW,WACpB,IAAIrB,EAAQP,EAAgB,SAC5B,OAAkB,OAAVO,GAA4B,KAAVA,uGC9DfsB,GADEC,OAFjB,WAA0B,IAAaC,EAAbC,KAAaC,eAA0BC,EAAvCF,KAAuCG,MAAAD,IAAAH,EAAwB,OAAAG,EAAA,OAAiBE,YAAA,aAAuBF,EAAA,OAAAA,EAAA,YAA2BE,YAAA,OAAAC,OAA0BC,KAAA,WAAe,GAA3KN,KAA2KO,GAAA,KAAAL,EAAA,OAAAA,EAAA,YAA2CE,YAAA,OAAAC,OAA0BC,KAAA,gBAAoB,GAApQN,KAAoQO,GAAA,KAAAL,EAAA,OAAAA,EAAA,YAA2CE,YAAA,OAAAC,OAA0BC,KAAA,aAAiB,GAA1VN,KAA0VO,GAAA,KAAAL,EAAA,OAAAA,EAAA,YAA2CE,YAAA,OAAAC,OAA0BC,KAAA,gBAAoB,MAE5bE,oBCCjB,ICUAC,GACAH,KAAA,MACAI,YAAAC,QDZyBvD,EAAQ,OAcjCwD,EEEAN,KAAA,YFAET,GATF,EAVA,SAAAgB,GACEzD,EAAQ,SAaV,kBAEA,MAUgC,UGvBjB0D,GADEhB,OAFP,WAAgB,IAAaC,EAAbC,KAAaC,eAA0BC,EAAvCF,KAAuCG,MAAAD,IAAAH,EAAwB,OAAAG,EAAA,OAAiBG,OAAOU,GAAA,SAAYb,EAAA,oBAE7FM,oBCChC,IAuBeQ,EAvBU5D,EAAQ,OAcjB6D,CACdR,EACAK,GAT6B,EAV/B,SAAoBD,GAClBzD,EAAQ,SAaS,KAEU,MAUG,gCCtBhC8D,IAAIC,IAAIC,KAER,IAAMC,EAAiB,IAAID,KACvBE,SAEQC,KAAM,IACNjB,KAAM,QACNkB,UAAW,kBAAMpE,EAAAqE,EAAA,GAAAC,KAAAtE,EAAAuE,KAAA,eACjBC,MACIC,MAAM,KAIVN,KAAM,SACNjB,KAAM,QACNkB,UAAW,kBAAMpE,EAAAqE,EAAA,GAAAC,KAAAtE,EAAAuE,KAAA,eACjBC,MACIC,MAAM,KAIVN,KAAM,SACNjB,KAAM,QACNkB,UAAW,kBAAMpE,EAAAqE,EAAA,GAAAC,KAAAtE,EAAAuE,KAAA,mBAK7BN,EAAeS,WAAW,SAACC,EAAIC,EAAM1C,GACjC,IAAI2C,EAAUF,EAAGH,KAAKC,OAAQ,EAC9BK,QAAQC,IAAI,UAAWF,EAASrC,gBAC5BqC,GAAYrC,cAIhBN,IAHIA,EAAK,YAKE+B,oEC5BfH,IAAIC,IAAIiB,KACRlB,IAAIC,IAAIkB,KACRnB,IAAIoB,UAAUC,WAAaC,IAC3BtB,IAAIoB,UAAUG,UCfVC,KAAM,IACNC,MAAO,KDeXzB,IAAIoB,UAAUM,MAAQC,IACtB3B,IAAIoB,UAAUQ,MAAQC,IACtB7B,IAAI8B,OAAOC,eAAgB,EAE3B,IAAI/B,KACAgC,GAAI,OACJC,SACA5F,UACAmD,YAAaD,OACb2C,SAAU,wHEtBRZ,GACFa,MAAO,GACPC,sBAAuB,KACvBC,OAAQ,GACRC,QAAS,KACTC,cAAe,IACfC,YAAa,KACbC,YAAa,KACbC,YAAY,EACZC,WAAY,EACZC,eAAgB,EAChBC,OAXe,WAeX,OAHqB,OAAjB/D,KAAKwD,SACLxD,KAAKgE,OAEFhE,KAAKwD,SAEhBQ,KAjBe,WAiBI,IAAdzF,EAAc0F,UAAAC,OAAA,QAAAhF,IAAA+E,UAAA,GAAAA,UAAA,GAAN,KACT,GAAqB,OAAjBjE,KAAKwD,QAGT,QAAKxD,KAAKmE,KAAKC,gBAGfpE,KAAKuD,OAAShF,GAASD,cACvB0B,KAAKqE,SACErE,OAEXmE,MACIC,YADE,WAEE,MAA0B,mBAAdE,YACRtE,KAAKuE,SAAS,uBACP,IAIfA,SARE,SAQO/E,GACLQ,KAAKqD,MAAQ7D,GAEjBgF,SAXE,WAYE,OAAOxE,KAAKqD,QAGpBgB,OA3Ce,WA4CX,IAAII,EAAQzE,KACZA,KAAK4D,YAAa,EAClB5D,KAAKwD,QAAU,IAAIc,UAAUI,EAAQC,kBAAmB3E,KAAKuD,QAC7DvD,KAAKwD,QAAQoB,OAAS,SAAUnD,GAC5BgD,EAAMI,MAAMpD,IAEhBzB,KAAKwD,QAAQsB,QAAU,SAAUrD,GAC7BgD,EAAMM,OAAOtD,IAEjBzB,KAAKwD,QAAQwB,UAAY,SAAUvD,GAC/BgD,EAAMQ,SAASxD,IAEnBzB,KAAKwD,QAAQ0B,QAAU,SAAUzD,GAC7BgD,EAAMU,OAAO1D,KAGrB2D,WA5De,WA4DF,IAAAC,EAAArF,KACTA,KAAK6E,MAAQ,SAACpD,GACVS,QAAQC,IAAI,OAAQV,GACpB4D,EAAKvB,eAAiB,EACtBuB,EAAKC,SAETtF,KAAK+E,OAAS,SAACtD,GACXS,QAAQC,IAAI,QAASV,IACpB4D,EAAKzB,YAAcyB,EAAKE,aAE7BvF,KAAKiF,SAAW,SAACxD,GACb,GAA0C,mBAA/B4D,EAAK/B,sBACZ,OAAO+B,EAAK/B,sBAAsB3E,KAAKC,MAAM6C,EAAE+D,QAKvDxF,KAAKmF,OAAS,SAAC1D,GACXS,QAAQC,IAAI,QAASV,GACrB4D,EAAKlB,KAAKI,SAAS9C,IAEvBzB,KAAKsF,MAAQ,WACTD,EAAK3B,YAAc+B,YAAY,WAC3BJ,EAAKtB,SAAS2B,KAAK/F,IAAekD,IAAK8C,UAIxCN,EAAK5B,gBAEZzD,KAAKuF,UAAY,WACbF,EAAKvB,iBACDuB,EAAKvB,eAAiBuB,EAAKxB,aAG/B+B,cAAcP,EAAK3B,aACnB2B,EAAKhB,WAETrE,KAAK0F,KAAO,SAACG,GACT,OAAQR,EAAKtB,SAAS+B,YAClB,KAAKxB,UAAUyB,KACXV,EAAKtB,SAAS2B,KAAK/F,IAAekG,IAClCR,EAAK/B,sBAAsBuC,GAC3B,MACJ,KAAKvB,UAAU0B,WACXC,WAAW,WACPZ,EAAKK,KAAKG,IACX,KACH,MACJ,KAAKvB,UAAU4B,OACf,KAAK5B,UAAU6B,QACXd,EAAKtB,SAASqC,UAK1BpG,KAAKoG,MAAQ,WAETR,cAAcP,EAAK3B,aACnB2B,EAAKzB,YAAa,EAClByB,EAAK7B,QAAQ4C,QACbf,EAAK7B,QAAU,QAK3BhB,EAAWc,sBAAwB+C,IACnC7D,EAAW4C,aAEI5C,uLC9HT8D,GACFC,UAAW,IAGTC,EAAe,WAClB,OACIC,UAAWH,EAAgBC,UAC3BG,OAAQlI,cACRmI,UAXIC,KAAKC,MAAM,IAAIC,MAAQC,UAAY,OAejChE,EAAe,SAAC0D,GACzBH,EAAgBC,UAAYE,GAGnB5D,GACT8C,KADgB,WAEZ,OACIqB,QAAS,OACTC,KAAM,IAGdC,KAPgB,SAOXF,GACD,OAAAG,KACIH,QAASA,EACTC,KAAM,IACNG,YAAa,KACVZ,MAGXa,MAfgB,SAeVC,GACF,OAAAH,KACIH,QAASM,EACTL,KAAM,IACNG,YAAa,KACVZ,6FCxCAe,GACXC,OACIC,gBAEIC,OAGRC,WACIC,SADO,SACEJ,EAAO3B,GAEZ,GADA3D,QAAQC,IAAI,WAAY0D,GACnB2B,EAAMC,eAAe5B,EAAQY,WAG3B,CACH,IAAIoB,gBAAWL,EAAMC,eAAe5B,EAAQY,aAAYZ,IACxD3E,IAAI4G,IAAIN,EAAMC,eAAgB5B,EAAQY,UAAWoB,QAJjD3G,IAAI4G,IAAIN,EAAMC,eAAgB5B,EAAQY,WAAYZ,KAQ1DkC,SAZO,SAYEP,EAZFQ,GAYkCA,EAAxBvB,UAAwBuB,EAAbC,aAIhCC,SACIC,KADK,SAAAC,EACUvC,IACXwC,EADoBD,EAAlBC,QACK,WAAYxC,KAG3ByC,iCC9BEC,GACF,QACA,OACA,OACA,SACA,OACA,SACA,WAEWC,GACXhB,OACIjJ,MAAO,GACPE,KAAM,GACN6B,KAAM,GACNmI,OAAQ,GACRC,KAAM,GACNC,OAAQ,GACRC,QAAS,IAEbjB,WACIkB,IADO,SACHrB,EAAO9I,GAAU,IAAAK,GAAA,EAAAC,GAAA,EAAAC,OAAAC,EAAA,IACjB,QAAAC,EAAAC,EAAA0J,IAAgBP,KAAhBxJ,GAAAI,EAAAC,EAAAE,QAAAC,MAAAR,GAAA,EAAsB,KAAbpB,EAAawB,EAAAvB,MAClB4J,EAAM7J,GAAOe,EAASf,IAFT,MAAA6B,GAAAR,GAAA,EAAAC,EAAAO,EAAA,aAAAT,GAAAK,EAAAK,QAAAL,EAAAK,SAAA,WAAAT,EAAA,MAAAC,KAKrB8J,MANO,SAMDvB,GAAO,IAAAwB,GAAA,EAAAC,GAAA,EAAAC,OAAAhK,EAAA,IACT,QAAAiK,EAAAC,EAAAN,IAAgBP,KAAhBS,GAAAG,EAAAC,EAAA9J,QAAAC,MAAAyJ,GAAA,EAAsB,CAClBxB,EADkB2B,EAAAvL,OACL,IAFR,MAAA4B,GAAAyJ,GAAA,EAAAC,EAAA1J,EAAA,aAAAwJ,GAAAI,EAAA3J,QAAA2J,EAAA3J,SAAA,WAAAwJ,EAAA,MAAAC,MAMjBhB,WACAmB,WChCJjM,EAAAkM,EAAAjM,EAAA,sBAAAkM,IAAAnM,EAAAkM,EAAAjM,EAAA,sBAAAmM,IAKAtI,IAAIC,IAAIsI,KACR,IAAMC,EAAgB,IAAID,IAAKE,OAC3BC,SACIC,IAAKC,EACLtB,KAAMuB,KAMDR,GAFEG,MAEgB,SAAChL,GAC5BgL,EAAcrB,OAAO,MAAO3J,KAGnB8K,EAAmB,WAC5BE,EAAcrB,OAAO","file":"static/js/app.8fd466489b21a1984aa0.js","sourcesContent":["import store from \"../../stores/index\"\n\nexport default (messageObj) => {\n    store.dispatch(\"push\", messageObj)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/library/message/handle.js","const PREFIX = \"Tsmwhite:\"\nexport const SetSessionStorage = (key, value) => {\n    window.sessionStorage.setItem(PREFIX + key, value);\n};\n\nexport const GetSessionStorage = (key) => {\n    return window.sessionStorage.getItem(PREFIX + key);\n};\n\nexport const SetLocalStorage = (key, value) => {\n    window.localStorage.setItem(PREFIX + key, value);\n};\n\nexport const GetLocalStorage = (key) => {\n    return window.localStorage.getItem(PREFIX + key);\n};\n\nexport const RemoveLocalStorage = (key) => {\n    return window.localStorage.removeItem(PREFIX + key);\n};\n\nconst localStorageKeys = [\n    \"token\",\n    \"user-info\"\n]\n\nconst Cache = {}\n\nexport const GetToken = () => {\n    if (!Cache.token) {\n        Cache.token = GetLocalStorage(\"token\")\n    }\n    return Cache.token\n}\n\nexport const GetCurrentUuid = () => {\n    if (!Cache.uuid) {\n        let userInfo = GetLocalStorage(\"user-info\")\n        userInfo = JSON.parse(userInfo)\n        Cache.uuid = userInfo.uuid\n    }\n    return Cache.uuid\n}\n\nexport const GetUserInfo = () => {\n    if (!Cache.userInfo) {\n        let userInfo = GetLocalStorage(\"user-info\")\n        Cache.userInfo = JSON.parse(userInfo)\n    }\n    return Cache.userInfo || {}\n}\n\nexport const LogoutAfterCache = () => {\n    for (let key of localStorageKeys) {\n        RemoveLocalStorage(key)\n    }\n}\n\nexport const LoginAfterCache = (userInfo) => {\n    SetLocalStorage(\"token\", userInfo.token)\n    SetLocalStorage(\"user-info\", JSON.stringify(userInfo))\n}\n\nexport const HasLogin = () => {\n    let token = GetLocalStorage(\"token\")\n    return (token !== null && token !== \"\")\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utis/cache.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-tab\"},[_c('div',[_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"chat\"}})],1),_vm._v(\" \"),_c('div',[_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"friends-o\"}})],1),_vm._v(\" \"),_c('div',[_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"fire-o\"}})],1),_vm._v(\" \"),_c('div',[_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"manager-o\"}})],1)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-0492bc3b\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/base/main-tab.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-0492bc3b\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./main-tab.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./main-tab.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./main-tab.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-0492bc3b\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./main-tab.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-0492bc3b\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/base/main-tab.vue\n// module id = null\n// module chunks = ","<template>\n    <div id=\"app\">\n        <router-view/>\n<!--        <keep-alive>-->\n<!--            <router-view/>-->\n<!--        </keep-alive>-->\n        <!--        <main-tab></main-tab>-->\n    </div>\n</template>\n\n<script>\nimport MainTab from \"./components/base/main-tab\";\n\nexport default {\n    name: 'App',\n    components: {MainTab}\n}\n</script>\n\n<style>\nhtml,body,#app {\n    height: 100%;\n}\n.h100 {\n    height: 100%;\n}\nbody {\n    background: #f7f7f7;\n}\n\n#app {\n    font-family: PingFang SC, 'Avenir', Helvetica, Arial, sans-serif;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n    text-align: center;\n    color: #2c3e50;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","<template>\n    <div class=\"main-tab\">\n        <div>\n            <van-icon class=\"icon\" name=\"chat\" />\n        </div>\n        <div>\n            <van-icon class=\"icon\" name=\"friends-o\" />\n        </div>\n        <div>\n            <van-icon class=\"icon\" name=\"fire-o\" />\n        </div>\n        <div>\n            <van-icon class=\"icon\" name=\"manager-o\" />\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"main-tab\"\n}\n</script>\n\n<style scoped lang=\"less\">\n.main-tab {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    width: 100%;\n    justify-content: space-between;\n    border-top: 1px solid #e1e6eb;\n    background: #f7f7f7;\n    > div {\n        margin: 12px 24px;\n        .van-icon {\n            font-size: 22px;\n        }\n    }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/base/main-tab.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5cb36158\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5cb36158\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5cb36158\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport {HasLogin} from \"../utis/cache\";\n\nVue.use(Router)\n\nconst RouterInstance = new Router({\n    routes: [\n        {\n            path: '/',\n            name: 'index',\n            component: () => import ('@/views/Index'),\n            meta: {\n                auth: true,\n            }\n        },\n        {\n            path: '/index',\n            name: 'index',\n            component: () => import ('@/views/Index'),\n            meta: {\n                auth: true,\n            }\n        },\n        {\n            path: '/login',\n            name: 'login',\n            component: () => import('@/views/login.vue'),\n        },\n    ]\n})\n\nRouterInstance.beforeEach((to, form, next) => {\n    let hasAuth = to.meta.auth || false\n    console.log(\"hasAuth\", hasAuth, HasLogin())\n    if (hasAuth && !HasLogin()) {\n        next(\"/login\");\n        return\n    }\n    next();\n})\nexport default RouterInstance\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport router from './router/index'\nimport Vant from 'vant';\nimport 'vant/lib/index.css';\nimport WEB_SOCKET from \"@/library/socket/web-socket\";\nimport {Message} from \"./library/message/type\";\nimport {Chat,setRecipient} from \"./library/message/chat\"\nimport {Lazyload} from 'vant';\nimport store from \"./stores/index\"\n\nVue.use(Lazyload);\nVue.use(Vant);\nVue.prototype.$WebSocket = WEB_SOCKET\nVue.prototype.$MsgType = Message\nVue.prototype.$Chat = Chat\nVue.prototype.$SetR = setRecipient\nVue.config.productionTip = false\n/* eslint-disable no-new */\nnew Vue({\n    el: '#app',\n    router,\n    store,\n    components: {App},\n    template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","export const Message = {\n    Text: 400,\n    Image: 401\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/library/message/type.js","import {Chat} from \"../message/chat\"\nimport mesHandleFunc from \"../message/handle\"\nimport {GetToken} from \"../../utis/cache\";\n\nconst WEB_SOCKET = {\n    Error: \"\",\n    MessageHandleCallback: null,\n    _token: \"\",\n    _socket: null,\n    _heartTimeout: 8000, // 心跳间隔\n    _heartTimer: null, // 保持心跳\n    _closeTimer: null, // 延时关闭\n    _closeFlag: false, // 主动关闭\n    _reConnMax: 1,    // 重连限制\n    _reConnCounter: 0, // 重连计数\n    Socket() {\n        if (this._socket === null) {\n            this.Init()\n        }\n        return this._socket\n    },\n    Init(token = null) {\n        if (this._socket !== null) {\n            return\n        }\n        if (!this.Func.isSupportWs()) {\n            return false\n        }\n        this._token = token || GetToken()\n        this.WsInit()\n        return this\n    },\n    Func: {\n        isSupportWs() {\n            if (typeof (WebSocket) != \"function\") {\n                this.setError(\"不支持 websocket 通信协议\")\n                return false\n            }\n            return true\n        },\n        setError(err) {\n            this.Error = err\n        },\n        getError() {\n            return this.Error\n        },\n    },\n    WsInit() {\n        let _this = this\n        this._closeFlag = false\n        this._socket = new WebSocket(process.WEB_SOCKET_SERVER, this._token)\n        this._socket.onopen = function (e) {\n            _this._OPEN(e)\n        }\n        this._socket.onclose = function (e) {\n            _this._CLOSE(e)\n        }\n        this._socket.onmessage = function (e) {\n            _this._MESSAGE(e)\n        }\n        this._socket.onerror = function (e) {\n            _this._ERROR(e)\n        }\n    },\n    WsFuncInit() {\n        this._OPEN = (e) => {\n            console.log('OPEN', e)\n            this._reConnCounter = 0\n            this.heart()\n        }\n        this._CLOSE = (e) => {\n            console.log('CLOSE', e)\n            !this._closeFlag && this.reconnect()\n        }\n        this._MESSAGE = (e) => {\n            if (typeof this.MessageHandleCallback === \"function\") {\n                return this.MessageHandleCallback(JSON.parse(e.data))\n            }\n            //clearTimeout(this._closeTimer)\n        }\n\n        this._ERROR = (e) => {\n            console.log('ERROR', e)\n            this.Func.setError(e)\n        }\n        this.heart = () => {\n            this._heartTimer = setInterval(() => {\n                this.Socket().send(JSON.stringify(Chat.ping()))\n                // this._closeTimer = setTimeout(() => {\n                //     this.close()\n                // }, this._heartTimeout)\n            }, this._heartTimeout)\n        }\n        this.reconnect = () => {\n            this._reConnCounter++\n            if (this._reConnCounter > this._reConnMax) {\n                return\n            }\n            clearInterval(this._heartTimer)\n            this.WsInit()\n        }\n        this.send = (message) => {\n            switch (this.Socket().readyState) {\n                case WebSocket.OPEN:\n                    this.Socket().send(JSON.stringify(message))\n                    this.MessageHandleCallback(message)\n                    break\n                case WebSocket.CONNECTING:\n                    setTimeout(() => {\n                        this.send(message)\n                    }, 3000)\n                    break\n                case WebSocket.CLOSED:\n                case WebSocket.CLOSING:\n                    this.Socket().close()\n                    break\n                default:\n            }\n        }\n        this.close = () => {\n            //clearTimeout(this._closeTimer)\n            clearInterval(this._heartTimer)\n            this._closeFlag = true\n            this._socket.close()\n            this._socket = null\n        }\n    }\n}\n\nWEB_SOCKET.MessageHandleCallback = mesHandleFunc\nWEB_SOCKET.WsFuncInit()\n\nexport default WEB_SOCKET\n\n\n\n// WEBPACK FOOTER //\n// ./src/library/socket/web-socket.js","import {GetCurrentUuid} from \"../../utis/cache\";\n\nconst time = () => {\n    return Math.ceil((new Date()).getTime() / 1000)\n}\n\nconst CurrentChatInfo = {\n    Recipient: \"\"\n}\n\nconst commonStruct = () => {\n   return {\n       recipient: CurrentChatInfo.Recipient,\n       sender: GetCurrentUuid(),\n       send_time: time()\n   }\n}\n\nexport const setRecipient = (recipient) => {\n    CurrentChatInfo.Recipient = recipient\n}\n\nexport const Chat = {\n    ping() {\n        return {\n            content: \"ping\",\n            type: 0,\n        }\n    },\n    text(content) {\n        return {\n            content: content,\n            type: 200,\n            second_type: 400,\n            ...commonStruct(),\n        }\n    },\n    image(address) {\n        return {\n            content: address,\n            type: 200,\n            second_type: 401,\n            ...commonStruct(),\n        }\n    },\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/library/message/chat.js","import Vue from \"vue\"\n\nexport default {\n    state: {\n        MessageMapList: {\n            // 消息接受者（房间id）：消息列表\n            0: [],\n        }\n    },\n    mutations: {\n        PUSH_MSG(state, message) {\n            console.log(\"PUSH_MSG\", message)\n            if (!state.MessageMapList[message.recipient]) {\n                Vue.set(state.MessageMapList, message.recipient, [message])\n                // state.MessageMapList[message.recipient] = []\n            } else {\n                let list = [...state.MessageMapList[message.recipient], message]\n                Vue.set(state.MessageMapList, message.recipient, list)\n                //state.MessageMapList[message.recipient].push(message)\n            }\n        },\n        READ_MSG(state, {recipient, messageIds}) {\n\n        },\n    },\n    actions: {\n        push({commit}, message) {\n            commit(\"PUSH_MSG\", message)\n        }\n    },\n    getters: {},\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/stores/modules/message.js","const keys = [\n    \"token\",\n    \"uuid\",\n    \"name\",\n    \"mobile\",\n    \"mail\",\n    \"avatar\",\n    \"role_id\",\n]\nexport default {\n    state: {\n        token: \"\",\n        uuid: \"\",\n        name: \"\",\n        mobile: \"\",\n        mail: \"\",\n        avatar: \"\",\n        role_id: \"\",\n    },\n    mutations: {\n        SET(state, userInfo) {\n            for (let key of keys) {\n                state[key] = userInfo[key]\n            }\n        },\n        CLEAR(state) {\n            for (let key of keys) {\n                state[key] = \"\"\n            }\n        },\n    },\n    actions: {},\n    getter: {},\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/stores/modules/user.js","import Vue from \"vue\"\nimport Vuex from \"vuex\"\nimport MsgStore from \"./modules/message\"\nimport UserStore from \"./modules/user\"\n\nVue.use(Vuex)\nconst storeInstance = new Vuex.Store({\n    modules: {\n        msg: MsgStore,\n        user: UserStore,\n    }\n})\n\nexport default storeInstance\n\nexport const LoginAfterStore = (userInfo) => {\n    storeInstance.commit(\"SET\", userInfo)\n}\n\nexport const LogoutAfterStore = () => {\n    storeInstance.commit(\"CLEAR\")\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/stores/index.js"],"sourceRoot":""}