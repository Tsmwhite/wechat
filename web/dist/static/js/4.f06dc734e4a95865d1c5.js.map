{"version":3,"sources":["webpack:///src/views/friend-notice.vue","webpack:///./src/views/friend-notice.vue?176c","webpack:///./src/views/friend-notice.vue"],"names":["friend_notice","name","components","ChatHeader","chat_header","data","defaultAvatar","currentRoom","type","loading","finished","messages","pagination","current","pageSize","total","loadLastId","computed","getUserInfo","_this","this","item","user","$store","state","friend","FriendMap","sender","Object","cookie","user_id","avatar","methods","loadHistory","_this2","common","size","last_id","then","res","_messages","len","length","container","document","getElementById","oldHeight","scrollHeight","id","map","_remark","push","apply","toConsumableArray_default","reverse","$nextTick","scrollToBottom","scrollTop","setTimeout","catch","handleApply","status","_this3","uuid","remark","$toast","success","msg","views_friend_notice","render","_vm","_h","$createElement","_c","_self","attrs","room-data","show-more-btn","_v","staticClass","finished-text","offset","direction","on","load","model","value","callback","$$v","expression","_l","index","key","src","_s","staticStyle","color","content","placeholder","maxlength","show-word-limit","$set","width","click","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/4.f06dc734e4a95865d1c5.js","sourcesContent":["<template>\n    <div>\n        <chat-header :room-data=\"currentRoom\" :show-more-btn=\"false\"></chat-header>\n        <div id=\"messageList\" class=\"message-list\">\n            <van-list id=\"messageListScroll\"\n                      v-model=\"loading\"\n                      :finished=\"finished\"\n                      finished-text=\"没有更多了\"\n                      @load=\"loadHistory\"\n                      :offset=\"80\"\n                      direction=\"up\">\n                <div v-for=\"(item,index) in messages\"\n                     :key=\"index\"\n                     class=\"message-box\">\n                    <div class=\"header\">\n                        <div class=\"left\">\n                            <div class=\"user-info\">\n                                <img class=\"avatar\" :src=\"getUserInfo(item).avatar || defaultAvatar\"/>\n                                <span class=\"name\">{{ getUserInfo(item).name }} </span>\n                            </div>\n                        </div>\n                        <div class=\"right\">\n                            <span style=\"color:rgba(0, 0, 0, 0.45)\">申请添加好友</span>\n                        </div>\n                    </div>\n                    <div class=\"content\">\n                        <div>\n                            <label>对方留言：</label>\n                            <span>\n                            {{ item.content }}\n                        </span>\n                        </div>\n                    </div>\n                    <template v-if=\"item.status == 0\">\n                        <div class=\"content\">\n                            <div>\n                                <label>设置备注：</label>\n                                <span>\n                                <van-field v-model=\"item._remark\"\n                                           placeholder=\"请输入备注（可选）\"\n                                           :maxlength=\"12\"\n                                           show-word-limit/>\n                            </span>\n                            </div>\n                        </div>\n                        <div class=\"footer\">\n                            <van-button size=\"small\" type=\"default\" style=\"width: calc(50% - 12px);\"\n                                        @click=\"handleApply(item,2)\">拒绝\n                            </van-button>\n                            <van-button size=\"small\" type=\"info\" style=\"width: calc(50% - 12px);\"\n                                        @click=\"handleApply(item,1)\">同意\n                            </van-button>\n                        </div>\n                    </template>\n                    <template v-else-if=\"item.status == 1\">\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\">已同意</van-tag>\n                        </div>\n                    </template>\n                    <template v-else-if=\"item.status == 2\">\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\" color=\"#ec6969\">已拒绝</van-tag>\n                        </div>\n                    </template>\n                    <template v-else>\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\" color=\"rgba(0,0,0,.25)\">已过期</van-tag>\n                        </div>\n                    </template>\n                </div>\n            </van-list>\n        </div>\n    </div>\n</template>\n\n<script>\nimport ChatHeader from \"../components/chat/base/chat-header\";\nimport {getFriendNotice, handleAddFriendApply} from \"../api/common\";\nimport {GetUserByUuid} from \"../utis/cookie\";\n\nexport default {\n    name: \"friend-notice\",\n    components: {\n        ChatHeader\n    },\n    data() {\n        return {\n            defaultAvatar: 'https://wwcdn.weixin.qq.com/node/wework/images/kf_head_image_url_4.png',\n            currentRoom: {\n                type: 0,\n                name: '好友通知',\n            },\n            loading: false,\n            finished: false,\n            messages: [],\n            pagination: {\n                current: 1,\n                pageSize: 10,\n                total: 0,\n                loadLastId: 0,\n            },\n        }\n    },\n    computed: {\n        getUserInfo() {\n            return (item) => {\n                let storeData = this.$store.state\n                let user = storeData.friend.FriendMap[item.sender]\n                if (!user) {\n                    GetUserByUuid({user_id: item.sender})\n                    return {\n                        avatar: this.defaultAvatar,\n                        name: '...',\n                    }\n                }\n                return user\n            }\n        },\n    },\n    methods: {\n        loadHistory() {\n            getFriendNotice({\n                size: this.pagination.pageSize,\n                last_id: this.pagination.loadLastId,\n            }).then(res => {\n                let len = res.data.length\n                if (len < 1) {\n                    this.finished = true\n                    this.loading = false\n                    return\n                }\n                const container = document.getElementById('messageList')\n                let oldHeight = container.scrollHeight\n                this.pagination.loadLastId = res.data[len - 1].id || 0\n                res.data.map(item => {\n                    item._remark = \"\"\n                })\n                this.messages.push(...res.data.reverse())\n                this.$nextTick(() => {\n                    if (this.pagination.current === 1) {\n                        this.scrollToBottom()\n                    } else {\n                        container.scrollTop = (container.scrollHeight - oldHeight)\n                    }\n                    this.pagination.current++\n                    setTimeout(() => {\n                        this.loading = false\n                    }, 3000)\n                })\n\n            }).catch(() => {\n                this.loading = false\n            })\n        },\n        handleApply(item, status) {\n            handleAddFriendApply({\n                uuid: item.uuid,\n                status: status,\n                remark: item._remark,\n            }).then(res => {\n                this.$toast.success(res.msg)\n            })\n        },\n        scrollToBottom() {\n            this.$nextTick(() => {\n                const container = document.getElementById('messageList')\n                container.scrollTop = container.scrollHeight\n            })\n        },\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n.message-box {\n    margin: 24px;\n    border-radius: 6px;\n    border: 1px solid #e8e8e8;\n    padding: 16px;\n    background: #ffffff;\n\n    .header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-bottom: 16px;\n        border-bottom: 1px solid #e8e8e8;\n    }\n\n    .content {\n        margin-top: 16px;\n        text-align: left;\n\n        > label {\n            color: rgba(0, 0, 0, 0.45);\n        }\n    }\n\n    .footer {\n        display: flex;\n        justify-content: space-between;\n        padding-top: 16px;\n        margin-top: 16px;\n    }\n\n    .status {\n        margin-top: 16px;\n        text-align: right;\n    }\n}\n\n.user-info {\n    display: flex;\n    align-items: center;\n\n    .avatar {\n        margin-right: 8px;\n        width: 36px;\n        height: 36px;\n        border-radius: 6px;\n    }\n\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/friend-notice.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('chat-header',{attrs:{\"room-data\":_vm.currentRoom,\"show-more-btn\":false}}),_vm._v(\" \"),_c('div',{staticClass:\"message-list\",attrs:{\"id\":\"messageList\"}},[_c('van-list',{attrs:{\"id\":\"messageListScroll\",\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"offset\":80,\"direction\":\"up\"},on:{\"load\":_vm.loadHistory},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.messages),function(item,index){return _c('div',{key:index,staticClass:\"message-box\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"left\"},[_c('div',{staticClass:\"user-info\"},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":_vm.getUserInfo(item).avatar || _vm.defaultAvatar}}),_vm._v(\" \"),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.getUserInfo(item).name)+\" \")])])]),_vm._v(\" \"),_c('div',{staticClass:\"right\"},[_c('span',{staticStyle:{\"color\":\"rgba(0, 0, 0, 0.45)\"}},[_vm._v(\"申请添加好友\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('div',[_c('label',[_vm._v(\"对方留言：\")]),_vm._v(\" \"),_c('span',[_vm._v(\"\\n                        \"+_vm._s(item.content)+\"\\n                    \")])])]),_vm._v(\" \"),(item.status == 0)?[_c('div',{staticClass:\"content\"},[_c('div',[_c('label',[_vm._v(\"设置备注：\")]),_vm._v(\" \"),_c('span',[_c('van-field',{attrs:{\"placeholder\":\"请输入备注（可选）\",\"maxlength\":12,\"show-word-limit\":\"\"},model:{value:(item._remark),callback:function ($$v) {_vm.$set(item, \"_remark\", $$v)},expression:\"item._remark\"}})],1)])]),_vm._v(\" \"),_c('div',{staticClass:\"footer\"},[_c('van-button',{staticStyle:{\"width\":\"calc(50% - 12px)\"},attrs:{\"size\":\"small\",\"type\":\"default\"},on:{\"click\":function($event){return _vm.handleApply(item,2)}}},[_vm._v(\"拒绝\\n                        \")]),_vm._v(\" \"),_c('van-button',{staticStyle:{\"width\":\"calc(50% - 12px)\"},attrs:{\"size\":\"small\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.handleApply(item,1)}}},[_vm._v(\"同意\\n                        \")])],1)]:(item.status == 1)?[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\"}},[_vm._v(\"已同意\")])],1)]:(item.status == 2)?[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"color\":\"#ec6969\"}},[_vm._v(\"已拒绝\")])],1)]:[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"color\":\"rgba(0,0,0,.25)\"}},[_vm._v(\"已过期\")])],1)]],2)}),0)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-57264336\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/friend-notice.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-57264336\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./friend-notice.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./friend-notice.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./friend-notice.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-57264336\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./friend-notice.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-57264336\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/friend-notice.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}