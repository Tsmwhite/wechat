{"version":3,"sources":["webpack:///src/views/friend-notice.vue","webpack:///./src/views/friend-notice.vue?d65b","webpack:///./src/views/friend-notice.vue"],"names":["friend_notice","name","components","ChatHeader","chat_header","data","renderAvatar","tools","defaultAvatar","currentRoom","type","loading","finished","messages","pagination","current","pageSize","total","loadLastId","methods","loadHistory","_this","this","$toast","message","duration","Object","common","size","last_id","then","res","_messages","len","length","container","document","getElementById","oldHeight","scrollHeight","id","map","item","_remark","push","apply","toConsumableArray_default","reverse","$nextTick","scrollToBottom","scrollTop","setTimeout","catch","finally","clear","handleApply","status","_this2","uuid","remark","success","msg","views_friend_notice","render","_vm","_h","$createElement","_c","_self","attrs","room-data","show-more-btn","_v","staticClass","finished-text","offset","direction","on","load","model","value","callback","$$v","expression","_l","index","key","src","avatar","_s","staticStyle","color","content","placeholder","maxlength","show-word-limit","$set","width","click","$event","description","_e","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/4.86d0a79b3510cebd65dd.js","sourcesContent":["<template>\n    <div>\n        <chat-header :room-data=\"currentRoom\" :show-more-btn=\"false\"></chat-header>\n        <div id=\"messageList\" class=\"message-list\">\n            <van-list id=\"messageListScroll\"\n                      v-model=\"loading\"\n                      :finished=\"finished\"\n                      finished-text=\"没有更多了\"\n                      @load=\"loadHistory\"\n                      :offset=\"80\"\n                      direction=\"up\">\n                <div v-for=\"(item,index) in messages\"\n                     :key=\"index\"\n                     class=\"message-box\">\n                    <div class=\"header\">\n                        <div class=\"left\">\n                            <div class=\"user-info\">\n                                <img class=\"avatar\" :src=\"item.avatar || defaultAvatar\"/>\n                                <span class=\"name\">{{ item.name || '--' }} </span>\n                            </div>\n                        </div>\n                        <div class=\"right\">\n                            <span style=\"color:rgba(0, 0, 0, 0.45)\">申请添加好友</span>\n                        </div>\n                    </div>\n                    <div class=\"content\">\n                        <div>\n                            <label>对方留言：</label>\n                            <span>\n                            {{ item.content }}\n                        </span>\n                        </div>\n                    </div>\n                    <template v-if=\"item.status == 0\">\n                        <div class=\"content\">\n                            <div>\n                                <label>设置备注：</label>\n                                <span>\n                                <van-field v-model=\"item._remark\"\n                                           placeholder=\"请输入备注（可选）\"\n                                           :maxlength=\"12\"\n                                           show-word-limit/>\n                            </span>\n                            </div>\n                        </div>\n                        <div class=\"footer\">\n                            <van-button size=\"small\" type=\"default\" style=\"width: calc(50% - 12px);\"\n                                        @click=\"handleApply(item,2)\">拒绝\n                            </van-button>\n                            <van-button size=\"small\" type=\"info\" style=\"width: calc(50% - 12px);\"\n                                        @click=\"handleApply(item,1)\">同意\n                            </van-button>\n                        </div>\n                    </template>\n                    <template v-else-if=\"item.status == 1\">\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\">已同意</van-tag>\n                        </div>\n                    </template>\n                    <template v-else-if=\"item.status == 2\">\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\" color=\"#ec6969\">已拒绝</van-tag>\n                        </div>\n                    </template>\n                    <template v-else>\n                        <div class=\"status\">\n                            <van-tag type=\"primary\" size=\"large\" color=\"rgba(0,0,0,.25)\">已过期</van-tag>\n                        </div>\n                    </template>\n                </div>\n            </van-list>\n            <van-empty v-if=\"messages.length < 1\" description=\"暂无消息\"></van-empty>\n        </div>\n    </div>\n</template>\n\n<script>\nimport ChatHeader from \"../components/chat/base/chat-header\";\nimport {getFriendNotice, handleAddFriendApply} from \"../api/common\";\nimport {renderAvatar} from \"../utis/tools\";\n\nexport default {\n    name: \"friend-notice\",\n    components: {\n        ChatHeader\n    },\n    data() {\n        return {\n            renderAvatar,\n            defaultAvatar: 'https://wwcdn.weixin.qq.com/node/wework/images/kf_head_image_url_4.png',\n            currentRoom: {\n                type: 0,\n                name: '好友通知',\n            },\n            loading: false,\n            finished: false,\n            messages: [],\n            pagination: {\n                current: 1,\n                pageSize: 10,\n                total: 0,\n                loadLastId: 0,\n            },\n        }\n    },\n    methods: {\n        loadHistory() {\n            this.$toast.loading({\n                message: \"加载中...\",\n                duration: 0,\n            })\n            getFriendNotice({\n                size: this.pagination.pageSize,\n                last_id: this.pagination.loadLastId,\n            }).then(res => {\n                let len = res.data.length\n                if (len < 1) {\n                    this.finished = true\n                    this.loading = false\n                    return\n                }\n                const container = document.getElementById('messageList')\n                let oldHeight = container.scrollHeight\n                this.pagination.loadLastId = res.data[len - 1].id || 0\n                res.data.map(item => {\n                    item._remark = \"\"\n                })\n                this.messages.push(...res.data.reverse())\n                this.$nextTick(() => {\n                    if (this.pagination.current === 1) {\n                        this.scrollToBottom()\n                    } else {\n                        container.scrollTop = (container.scrollHeight - oldHeight)\n                    }\n                    this.pagination.current++\n                    setTimeout(() => {\n                        this.loading = false\n                    }, 3000)\n                })\n\n            }).catch(() => {\n                this.loading = false\n                this.finished = true\n            }).finally(() => this.$toast.clear())\n        },\n        handleApply(item, status) {\n            handleAddFriendApply({\n                uuid: item.uuid,\n                status: status,\n                remark: item._remark,\n            }).then(res => {\n                item.status = status\n                this.$toast.success(res.msg)\n            })\n        },\n        scrollToBottom() {\n            this.$nextTick(() => {\n                const container = document.getElementById('messageList')\n                container.scrollTop = container.scrollHeight\n            })\n        },\n    }\n}\n</script>\n\n<style scoped lang=\"less\">\n.message-box {\n    margin: 24px;\n    border-radius: 6px;\n    border: 1px solid #e8e8e8;\n    padding: 16px;\n    background: #ffffff;\n\n    .header {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        padding-bottom: 16px;\n        border-bottom: 1px solid #e8e8e8;\n    }\n\n    .content {\n        margin-top: 16px;\n        text-align: left;\n\n        > label {\n            color: rgba(0, 0, 0, 0.45);\n        }\n    }\n\n    .footer {\n        display: flex;\n        justify-content: space-between;\n        padding-top: 16px;\n        margin-top: 16px;\n    }\n\n    .status {\n        margin-top: 16px;\n        text-align: right;\n    }\n}\n\n.user-info {\n    display: flex;\n    align-items: center;\n\n    .avatar {\n        margin-right: 8px;\n        width: 36px;\n        height: 36px;\n        border-radius: 6px;\n    }\n\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/friend-notice.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('chat-header',{attrs:{\"room-data\":_vm.currentRoom,\"show-more-btn\":false}}),_vm._v(\" \"),_c('div',{staticClass:\"message-list\",attrs:{\"id\":\"messageList\"}},[_c('van-list',{attrs:{\"id\":\"messageListScroll\",\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"offset\":80,\"direction\":\"up\"},on:{\"load\":_vm.loadHistory},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.messages),function(item,index){return _c('div',{key:index,staticClass:\"message-box\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"left\"},[_c('div',{staticClass:\"user-info\"},[_c('img',{staticClass:\"avatar\",attrs:{\"src\":item.avatar || _vm.defaultAvatar}}),_vm._v(\" \"),_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(item.name || '--')+\" \")])])]),_vm._v(\" \"),_c('div',{staticClass:\"right\"},[_c('span',{staticStyle:{\"color\":\"rgba(0, 0, 0, 0.45)\"}},[_vm._v(\"申请添加好友\")])])]),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('div',[_c('label',[_vm._v(\"对方留言：\")]),_vm._v(\" \"),_c('span',[_vm._v(\"\\n                        \"+_vm._s(item.content)+\"\\n                    \")])])]),_vm._v(\" \"),(item.status == 0)?[_c('div',{staticClass:\"content\"},[_c('div',[_c('label',[_vm._v(\"设置备注：\")]),_vm._v(\" \"),_c('span',[_c('van-field',{attrs:{\"placeholder\":\"请输入备注（可选）\",\"maxlength\":12,\"show-word-limit\":\"\"},model:{value:(item._remark),callback:function ($$v) {_vm.$set(item, \"_remark\", $$v)},expression:\"item._remark\"}})],1)])]),_vm._v(\" \"),_c('div',{staticClass:\"footer\"},[_c('van-button',{staticStyle:{\"width\":\"calc(50% - 12px)\"},attrs:{\"size\":\"small\",\"type\":\"default\"},on:{\"click\":function($event){return _vm.handleApply(item,2)}}},[_vm._v(\"拒绝\\n                        \")]),_vm._v(\" \"),_c('van-button',{staticStyle:{\"width\":\"calc(50% - 12px)\"},attrs:{\"size\":\"small\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.handleApply(item,1)}}},[_vm._v(\"同意\\n                        \")])],1)]:(item.status == 1)?[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\"}},[_vm._v(\"已同意\")])],1)]:(item.status == 2)?[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"color\":\"#ec6969\"}},[_vm._v(\"已拒绝\")])],1)]:[_c('div',{staticClass:\"status\"},[_c('van-tag',{attrs:{\"type\":\"primary\",\"size\":\"large\",\"color\":\"rgba(0,0,0,.25)\"}},[_vm._v(\"已过期\")])],1)]],2)}),0),_vm._v(\" \"),(_vm.messages.length < 1)?_c('van-empty',{attrs:{\"description\":\"暂无消息\"}}):_vm._e()],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5e1d4f13\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/friend-notice.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5e1d4f13\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./friend-notice.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./friend-notice.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./friend-notice.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5e1d4f13\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./friend-notice.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5e1d4f13\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/friend-notice.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}